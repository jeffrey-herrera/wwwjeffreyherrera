---
import SanityImage from './SanityImage.astro';
import type { SanityImage as SanityImageType } from '../sanity/types';

interface Props {
  profileImage: SanityImageType;
  title: string;
  class?: string;
}

const { profileImage, title, class: className = '' } = Astro.props;

// Get all the about images from public/images/about
const aboutImages = [
  'About13.png',
  'About3.png', 
  'About4.png',
  'About5.png',
  'About6.png',
  'About7.png',
  'About8.png',
  'About9.png',
  'About2.png',
  'About11.png',
  'About12.png',
  'About10.png'
];
---

<div class={`stacked-profile-container ${className}`}>
  <!-- Background stack images -->
  {aboutImages.map((imageName, index) => (
    <div 
      class="stack-image"
      style={`transform: translate(${(index + 1) * 8}px, 0px); z-index: ${aboutImages.length - index};`}
    >
      <img 
        src={`/images/about/${imageName}`}
        alt={`About image ${index + 1}`}
        class="w-full h-full object-cover rounded-lg"
        loading="lazy"
      />
    </div>
  ))}
  
  <!-- Main profile image on top -->
  <div 
    class="stack-image main-image"
    style={`z-index: ${aboutImages.length + 2};`}
  >
    <SanityImage 
      source={profileImage}
      alt={profileImage.alt || title}
      variant="profile"
      class="w-full h-full object-cover rounded-lg"
      priority={true}
    />
  </div>
</div>

<style>
  .stacked-profile-container {
    position: relative;
    width: 16rem; /* w-64 */
    aspect-ratio: 3/4;
    transition: transform 0.3s ease;
  }

  .stack-image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    border-radius: 0.375rem;
    overflow: hidden;
    border: 2px solid rgb(248 250 252);
  }

  /* Hover effect - massive horizontal flare out */
  .stacked-profile-container:hover .stack-image:nth-child(1) {
    transform: translate(240px, 0px) !important;
  }
  
  .stacked-profile-container:hover .stack-image:nth-child(2) {
    transform: translate(440px, 0px) !important;
  }
  
  .stacked-profile-container:hover .stack-image:nth-child(3) {
    transform: translate(640px, 0px) !important;
  }
  
  .stacked-profile-container:hover .stack-image:nth-child(4) {
    transform: translate(840px, 0px) !important;
  }
  
  .stacked-profile-container:hover .stack-image:nth-child(5) {
    transform: translate(1040px, 0px) !important;
  }
  
  .stacked-profile-container:hover .stack-image:nth-child(6) {
    transform: translate(1240px, 0px) !important;
  }
  
  .stacked-profile-container:hover .stack-image:nth-child(7) {
    transform: translate(1440px, 0px) !important;
  }
  
  .stacked-profile-container:hover .stack-image:nth-child(8) {
    transform: translate(1640px, 0px) !important;
  }
  
  .stacked-profile-container:hover .stack-image:nth-child(9) {
    transform: translate(1840px, 0px) !important;
  }
  
  .stacked-profile-container:hover .stack-image:nth-child(10) {
    transform: translate(2040px, 0px) !important;
  }
  
  .stacked-profile-container:hover .stack-image:nth-child(11) {
    transform: translate(2240px, 0px) !important;
  }
  
  .stacked-profile-container:hover .stack-image:nth-child(12) {
    transform: translate(2440px, 0px) !important;
  }

  /* Main image stays in place */
  .stacked-profile-container:hover .main-image {
    transform: translate(0, 0) !important;
  }

  /* Add a subtle scale effect to the whole container on hover */
  .stacked-profile-container:hover {
    transform: scale(1.02);
  }
</style> 